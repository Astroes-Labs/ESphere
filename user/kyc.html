<?php 
    $endpoint = '../vendor/php/view.php'; 
    include_once $endpoint; 
?>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="csrf-token" content="SBch0PBGW3dm5rRbjq5RSsqEobLxipyXGsu8WLvm">
    <meta name="keywords" content="<?php echo WEBSITE_NAME; ?>">
    <meta name="description" content="<?php echo WEBSITE_NAME; ?>">
    <link rel="canonical" href="../user/kyc" />
    <link rel="shortcut icon" href="../assets/global/images/8asAPVg73gU9Kr32Z2dv.png" type="image/x-icon" />

    <link rel="icon" href="../assets/global/images/8asAPVg73gU9Kr32Z2dv.png" type="image/x-icon" />
    <link rel="stylesheet" href="../assets/global/css/fontawesome.min.css" />
    <link rel="stylesheet" href="../assets/frontend/css/vendor/bootstrap.min.css" />
    <link rel="stylesheet" href="../assets/frontend/css/animate.css" />
    <link rel="stylesheet" href="../assets/frontend/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="../assets/global/css/nice-select.css" />
    <link rel="stylesheet" href="../assets/global/css/datatables.min.css" />
    <link rel="stylesheet" href="../assets/global/css/simple-notify.min.css" />
    <link rel="stylesheet" type="text/css" href="../assets/vendor/mckenziearts/laravel-notify/css/notify.css" />
    <link rel="stylesheet" href="../assets/global/css/custom.css" />
    <link rel="stylesheet" href="../assets/frontend/css/magnific-popup.css" />
    <link rel="stylesheet" href="../assets/frontend/css/styles.css?var=2.1" />
    <!-- Include Toastr CSS -->
    <link rel="stylesheet" href="../assets/frontend/css/toastr.min.css">

    <style>
        //The Custom CSS will be added on the site head tag 
        .site-head-tag {
            margin: 0;
            padding: 0;
        }
    </style>

    <title>
        <?php echo WEBSITE_NAME; ?> - KYC
    </title>


</head>

<body class="dark-theme">
    <script>
        var notify = {
            timeout: "5000",
        }
    </script>
    <!--Full Layout-->
    <div class="panel-layout">
        <!--Header-->
        <div class="panel-header">
            <div class="logo">
                <a href="..">
                    <img class="logo-unfold" src="../assets/global/images/fQqFMZn3e0VAvI05KvFR.png" alt="Logo" />
                    <img class="logo-fold" src="../assets/global/images/fQqFMZn3e0VAvI05KvFR.png" alt="Logo" />
                </a>
            </div>
            <div class="nav-wrap">
                <div class="nav-left">
                    <button class="sidebar-toggle">
                        <i class="anticon anticon-arrow-left"></i>
                    </button>
                    <div class="mob-logo">
                        <a href="..">
                            <img src="../assets/global/images/fQqFMZn3e0VAvI05KvFR.png" alt="Site Name" />
                        </a>
                    </div>
                </div>
                <div class="nav-right">
                    <div class="single-nav-right">

                        <div class="single-right">
                            <div class="color-switcher">
                                <i icon-name="moon" class="dark-icon" data-mode="dark"></i>
                                <i icon-name="sun" class="light-icon" data-mode="light"></i>
                            </div>
                        </div>


                        <?php echo $_SESSION['noticeDropDown']; ?>


                        <div class="single-right">
                            <select name="language" id="" class="site-nice-select"
                                onchange="window.location.href=this.options[this.selectedIndex].value;">
                                <option value="../language-update?name=en" selected>English</option>
                                <option value="../language-update?name=es">Spanish</option>
                                <option value="../language-update?name=fr">Franch</option>
                            </select>
                        </div>
                       
                        <div class="single-right">
                            <button type="button" class="item" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="anticon anticon-user"></i>
                            </button>
                            <?php echo $navMini; ?>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--/Header-->

        <div class="desktop-screen-show">
            <div class="side-nav ">
                <div class="side-wallet-box default-wallet mb-0">
                    <?php echo $balanceHolder; ?>
                </div>
                <div class="side-nav-inside">
                    <?php echo $navMenu; ?>
                </div>
            </div>
        </div>


        <div class="page-container">
            <div class="main-content">
                <div class="section-gap">
                    <div class="container-fluid">

                        <div class="row desktop-screen-show">
                            <div class="col">
                               <?php echo $_SESSION['kycAlert']; ?>
                            </div>
                        </div>
                        <div class="row mobile-screen-show">
                            <div class="col-12">
                               <?php echo $_SESSION['kycAlertMobile']; ?>
                            </div>
                        </div>
                        <!--Page Content-->
                        <div class="row justify-content-center">
                            <div class="col-xl-8 col-lg-12 col-md-12 col-sm-12 col-12">
                                <div class="site-card">
                                    <div class="site-card-header">
                                        <h3 class="title">KYC</h3>
                                    </div>

                                    <div class="site-card-body <?php echo $_SESSION['kycFormVisibility']; ?>">
                                        <form action="" method="post" enctype="multipart/form-data" id="kycForm">
                                            <input type="hidden" name="submitKyc"
                                                value="SBch0PBGW3dm5rRbjq5RSsqEobLxipyXGsu8WLvm">
                                            <div class="col-xl-12 col-md-12">
                                                <div class="progress-steps-form">
                                                    <label for="exampleFormControlInput1"
                                                        class="form-label">Verification Type</label>
                                                    <div class="input-group">
                                                        <select name="kyc_id" id="kycTypeSelect"
                                                            class="site-nice-select" required>
                                                            <option selected disabled>----</option>
                                                            <option value="1">ID Verification</option>

                                                        </select>
                                                    </div>
                                                </div>

                                            </div>

                                            <div class="col-xl-12 col-md-12">
                                                <div class="row kycData">

                                                </div>
                                            </div>

                                            <button type="submit" class="site-btn blue-btn mt-3">Submit Now</button>
                                        </form>
                                    </div>

                                    <div class="site-card-body <?php echo $_SESSION['kycInfoVisibility']; ?>">
                                    <?php
                                        if(isset($_SESSION['kycFormMessage'])){
                                            echo $_SESSION['kycFormMessage'];
                                        }

                                    ?>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--Page Content-->
                    </div>
                </div>
            </div>
        </div>



        <!-- Show in 575px in Mobile Screen -->
        <div class="mobile-screen-show">
            <?php echo $navMobile; ?>
        </div>


        <!-- Show in 575px in Mobile Screen End -->

        <!-- Automatic Popup -->

        <!-- /Automatic Popup End -->
    </div>
    <!--/Full Layout-->

    <script src="../assets/global/js/jquery.min.js"></script>
    <!-- Include Toastr JS -->
    <script src="../home/static/auth/js/toastr.min.js"></script>
    <script src="../assets/global/js/jquery-migrate.js"></script>

    <script src="../assets/frontend/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/frontend/js/scrollUp.min.js"></script>

    <script src="../assets/frontend/js/owl.carousel.min.js"></script>
    <script src="../assets/global/js/waypoints.min.js"></script>
    <script src="../assets/frontend/js/jquery.counterup.min.js"></script>
    <script src="../assets/global/js/jquery.nice-select.min.js"></script>
    <script src="../assets/global/js/lucide.min.js"></script>
    <script src="../assets/frontend/js/magnific-popup.min.js"></script>
    <script src="../assets/frontend/js/aos.js"></script>
    <script src="../assets/global/js/datatables.min.js" type="text/javascript" charset="utf8"></script>
    <script src="../assets/global/js/simple-notify.min.js"></script>
    <script src="../assets/frontend/js/main.js?var=5"></script>
    <script src="../assets/frontend/js/cookie.js"></script>
    <script src="../assets/global/js/custom.js?var=5"></script>
    <script src="../assets/global/js/pusher.min.js"></script>
    <script>
            (function ($) {
                'use strict';

                let pusherAppKey = "";
                let pusherAppCluster = "mt1";
                let soundUrl = "../notification-tune";

                var notification = new Pusher(pusherAppKey, {
                    encrypted: true,
                    cluster: pusherAppCluster,
                });
                var channel = notification.subscribe('user-notification109');
                channel.bind('notification-event', function (result) {
                    playSound();
                    latestNotification();
                    notifyToast(result);
                });

                function latestNotification() {
                    $.get('../user/latest-notification', function (data) {
                        $('.user-notifications109').html(data);
                    })
                }

                function notifyToast(data) {
                    new Notify({
                        status: 'info',
                        title: data.data.title,
                        text: data.data.notice,
                        effect: 'slide',
                        speed: 300,
                        customClass: '',
                        customIcon: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-megaphone"><path d="m3 11 18-5v12L3 14v-3z"></path><path d="M11.6 16.8a3 3 0 1 1-5.8-1.6"></path></svg>',
                        showIcon: true,
                        showCloseButton: true,
                        autoclose: true,
                        autotimeout: 9000,
                        gap: 20,
                        distance: 20,
                        type: 1,
                        position: 'right bottom',
                        customWrapper: '<div><a href="' + data.data.action_url + '" class="learn-more-link">Explore<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" icon-name="external-link" class="lucide lucide-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg></a></div>',
                    })

                }

                function playSound() {
                    $.get(soundUrl, function (data) {
                        var audio = new Audio(data);
                        audio.play();
                        audio.muted = false;
                    });
                }



            })(jQuery);
    </script>
    <script>
        (function ($) {
            'use strict';
            // To top
            $.scrollUp({
                scrollText: '<i class="fas fa-caret-up"></i>',
                easingType: 'linear',
                scrollSpeed: 500,
                animation: 'fade'
            });
        })(jQuery);
    </script>

    <script type="text/javascript" src="../assets/vendor/mckenziearts/laravel-notify/js/notify.js"></script>
    <script>
        $("#kycTypeSelect").on('change', function (e) {
            "use strict"
            e.preventDefault();

            $('.kycData').empty();

            var id = $(this).val();
            if(id === '1'){
                $.ajax({
                    url: endpoint,
                    type: "POST",
                    dataType: "json",
                    data: {
                        getKycData: id,
                    },
                    success: function (data) {

                        if (data.credentials !== undefined) {
                            $('.kycData').append(data.credentials);
                            console.log(data.credentials);
                        }
                    },
                    error: function (xhr, status, error) {
                        // Handle errors here
                        console.error(xhr.responseText);
                    }
                });
            }

        });


        $(document).ready(function () {
            $('#kycForm')[0].reset();

            $('#kycForm').submit(function (e) {
                e.preventDefault(); 
                var formData = new FormData(this);
                $.ajax({
                    url: endpoint,
                    type: "POST",
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (result) {
                        if (result.message === 'success') {
                            $('#kycForm')[0].reset();
                            toastr.success("KYC Updated");
                            setTimeout(function () {
                                // body...
                                window.location.href = "kyc.html";
                            },2000);
                        }
                        if (result.message === 'error') {
                            toastr.error(result.error);
                        }
                        console.log("Success");
                        
                    },
                    error: function (xhr, status, error) {
                        // Handle errors, e.g., show error message
                        console.log('Error: ' + error);
                    }
                });
            });

        });

      $(document).ready(function() {
    $(document).on('change', '.idfront', function() {
        var file = this.files[0];
        if (file) {
            var reader = new FileReader();
            reader.onload = function(e) {
                $('.upload-icon').attr('src', e.target.result);
                $('#fileNameLabel').text(file.name); // Update span text with file name

                // Add CSS styles dynamically
                $('#fileNameLabel').css({
                    'position': 'absolute',
                    'bottom': '0',
                    'left': '0',
                    'width': '100%',
                    'padding': '0.3rem',
                    'font-size': '14px',
                    'font-weight': '700',
                    'color': '#ffffff',
                    'background-color': 'rgba(231, 54, 103, 0.5)'
                });// Add CSS styles dynamically
                $('.upload-icon').css({
                    'width': '50%'
                });
            };
            reader.readAsDataURL(file);
        }
    });
});




    </script>
    <script>
        // Color Switcher
        $(".color-switcher").on('click', function () {
            "use strict"
            $("body").toggleClass("dark-theme");
            var url = '../theme-mode';
            $.get(url)
        });


    </script>



<!-- 
<div class=\"col-xl-12 col-md-12\">
    <div class=\"progress-steps-form\">
        <label for=\"exampleFormControlInput1\" class=\"form-label\">Name</label>
        <div class=\"input-group\">
            <input type=\"text\" name=\"kyc_credential[Name]\" required=\"\" class=\"form-control\" aria-label=\"Amount\"
                id=\"amount\" aria-describedby=\"basic-addon1\">
        </div>
    </div>
</div>


<div class=\"col-xl-12 col-md-12\">
    <div class=\"progress-steps-form\">
        <label for=\"exampleFormControlInput1\" class=\"form-label\">State</label>
        <div class=\"input-group\">
            <input type=\"text\" name=\"kyc_credential[State]\" required=\"\" class=\"form-control\" aria-label=\"Amount\"
                id=\"amount\" aria-describedby=\"basic-addon1\">
        </div>
    </div>
</div>


<div class=\"col-xl-12 col-md-12\">
    <div class=\"body-title\">Front of ID</div>
    <div class=\"wrap-custom-file\">
        <input type=\"file\" name=\"kyc_credential[Front of ID]\" id=\"5\" accept=\".gif, .jpg, .png\" required=\"\">
        <label for=\"5\">
            <img class=\"upload-icon\" src=\"https://passport.cmaxtrade.com/assets/global/materials/upload.svg\" alt=\"\">
            <span>Select Front of ID</span>
        </label>
    </div>
</div> -->


</body>

</html>